# ğŸ” ì¶”ë¡  ì„¤ì • íŒŒì¼ (ì•µì»¤ ë°©ì‹ ê°œì„ ëœ ë²„ì „)
# ëª¨ë¸ ê²½ë¡œì™€ ë°ì´í„° ê²½ë¡œë¥¼ ì§ì ‘ ì…ë ¥í•˜ì—¬ ì¶”ë¡  ì‹¤í–‰

# ğŸ¯ ê³µí†µ ì„¤ì • ì •ì˜ (ì•µì»¤)
defaults: &defaults
  # ğŸ“Š ì…ë ¥ ë°ì´í„° ê²½ë¡œ
  data:
    input_path: &default_data_path "data/09_inference_input/test.parquet"
    
  # ğŸ¯ ëª¨ë¸ ê²½ë¡œ  
  model:
    checkpoint_path: &default_checkpoint_path "/home/user/projects/my_project/pj_mlflow_ds3/mlruns/472248896223754014/a676b9727b3b433d8507ad2140b430f9/artifacts/checkpoints/epoch_04"
    checkpoint_type: &default_checkpoint_type "deepspeed"
    
  # ğŸ“Š ë©”íƒ€ë°ì´í„° ê²½ë¡œ (í•„ìš”ì‹œ ì¶”ê°€)
    
  # ğŸ“ ì¶œë ¥ ê²½ë¡œ
  output:
    result_dir: &default_output_dir "./data/09_inference_output"

  
# ğŸ“Š ì‹¤ì œ ì„¤ì • (ê¸°ë³¸ ë‹¨ì¼GPU ì„¤ì •)
data:
  input_path: *default_data_path
  
model:
  checkpoint_path: *default_checkpoint_path
  checkpoint_type: *default_checkpoint_type
  use_lora: true
  
# metadata ì„¹ì…˜ ì œê±° (ì‚¬ìš©í•˜ì§€ ì•ŠìŒ)
  
output:
  result_dir: *default_output_dir
  
# âš™ï¸ ì¶”ë¡  ì„¤ì •
inference:
  batch_size: 128        # ì¶”ë¡  ë°°ì¹˜ í¬ê¸°. CLI --batch-size ë¡œ ì˜¤ë²„ë¼ì´ë“œ ê°€ëŠ¥.
  max_samples: null       # ìµœëŒ€ ì²˜ë¦¬ ìƒ˜í”Œ ìˆ˜ (null=ì „ì²´, ìˆ«ì=ì œí•œ)
  max_length: 256      # í† í¬ë‚˜ì´ì € ìµœëŒ€ ê¸¸ì´
  confidence_mode: "max"  # confidence ê³„ì‚° ë°©ì‹: "max"=ìµœëŒ€ê°’, "sampled"=í™•ë¥ ë¶„í¬ ìƒ˜í”Œë§

# ğŸ”§ ì „ì²˜ë¦¬ ì„¤ì • (ë©”íƒ€ë°ì´í„° ê¸°ë°˜ ìë™ ì²˜ë¦¬)
preprocessing:
  save_preprocessed_sample: true  # ì „ì²˜ë¦¬ëœ ë°ì´í„° ìƒ˜í”Œ ì €ì¥ ì—¬ë¶€
  sample_size: null  # ì €ì¥í•  ìƒ˜í”Œ í¬ê¸° (null=ì „ì²´)
  
# ğŸ–¥ï¸ GPU ì„¤ì •
gpu:
  gpu_id: 0  # CLI --gpu-id ë¡œ ì˜¤ë²„ë¼ì´ë“œ ê°€ëŠ¥
  deepspeed_inference: true

# ğŸ”§ DeepSpeed ì¶”ë¡  ì„¤ì •
deepspeed:
  replace_with_kernel_inject: false
  dtype: "bfloat16"
  max_out_tokens: 1
  replace_method: "auto"

